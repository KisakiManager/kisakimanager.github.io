<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Subir √çtem ‚Äî Kisaki Manager</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <style>
    /* Estilo para el panel de suscripci√≥n (oculto por defecto) */
    .hidden-fields {
      display: none;
      background: rgba(59, 130, 246, 0.1);
      padding: 15px;
      border-radius: 12px;
      border: 1px dashed #3b82f6;
      margin-bottom: 20px;
      animation: fadeIn 0.3s ease;
    }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }

    /* ESTILOS NUEVOS: BARRA DE PROGRESO */
    .progress-container {
      width: 100%;
      background-color: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      margin-top: 15px;
      height: 10px;
      overflow: hidden;
      display: none; /* Oculto hasta que se inicie la subida */
    }

    .progress-bar {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #ccf381, #a3e635);
      border-radius: 10px;
      transition: width 0.2s ease;
    }

    .upload-status-text {
      font-size: 0.85em;
      color: #94a3b8;
      text-align: center;
      margin-top: 8px;
      display: none;
    }
  </style>
</head>
<body>

  <div class="page-header" style="height: 120px; background-image: url('fondo-market.jpg');">
    <a href="marketplace.html" class="back-floating">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18l-6-6 6-6"/></svg>
    </a>
  </div>

  <div class="content-card" style="margin-top: -30px;">

    <div class="card-header-inner">
      <div class="page-title">
        <h1>Vender √çtem</h1>
        <span>Sube tu contenido al Marketplace</span>
      </div>
    </div>

    <div class="card-body">

      <form action="#" method="POST" id="uploadForm">

        <div class="form-group">
          <label class="form-label">Categor√≠a</label>
          <select class="form-select" id="categorySelect" onchange="toggleSubFields()">
            <option value="art">Ilustraciones</option>
            <option value="sub">Suscripci√≥n Canal (Requiere Admin)</option>
            <option value="sticker">Stickers</option>
            <option value="photo">Fotograf√≠a</option>
            <option value="video">Videos</option>
            <option value="other">Otros</option>
          </select>
        </div>

        <div id="subFields" class="hidden-fields">
          <h3 style="color:#60a5fa; margin-top:0; font-size:1em; display:flex; align-items:center; gap:8px;">
            <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>
            Configuraci√≥n de Canal
          </h3>
          <p style="font-size:0.85em; color:#cbd5e1; margin-bottom:15px;">El bot debe ser administrador del canal para gestionar los enlaces de invitaci√≥n.</p>

          <div class="form-group">
            <label class="form-label">Enlace del Canal (Privado)</label>
            <input type="text" class="form-input" placeholder="https://t.me/+AbCdEfGh...">
          </div>

          <div class="form-group">
            <label class="form-label">Duraci√≥n del Acceso</label>
            <select class="form-select">
              <option>1 Mes</option>
              <option>3 Meses</option>
              <option>6 Meses</option>
              <option>1 A√±o</option>
              <option>Permanente (Lifetime)</option>
            </select>
          </div>
        </div>

        <div class="form-group" id="fileField">
          <label class="form-label">Archivo del producto (Zip, PNG, MP4)</label>
          
          <div class="upload-area" id="dropZone">
            <svg class="upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
            <p id="fileNameDisplay" style="margin:0; color:#cbd5e1;">Toca para subir o arrastra aqu√≠</p>
            <input type="file" id="realFileInput" style="display: none;"> 
          </div>

          <div class="progress-container" id="uploadProgressBox">
            <div class="progress-bar" id="uploadProgressBar"></div>
          </div>
          <p class="upload-status-text" id="uploadStatus">Iniciando subida... 0%</p>
        </div>

        <div class="form-group">
          <label class="form-label">T√≠tulo del √çtem</label>
          <input type="text" class="form-input" placeholder="Ej: Pack Premium">
        </div>

        <div class="form-group">
          <label class="form-label">Precio y Moneda</label>

          <div class="currency-toggle" style="margin-bottom: 10px;">
            <div class="currency-option active" onclick="selectCurrency(this, 'TON')">üíé TON</div>
            <div class="currency-option" onclick="selectCurrency(this, 'STARS')">‚≠ê Stars</div>
          </div>

          <input type="number" class="form-input" placeholder="Cantidad (Ej: 2.5)">
          <span class="commission-note">‚ÑπÔ∏è Se descontar√° un 7% de comisi√≥n por venta.</span>
        </div>

        <div class="form-group">
          <label class="form-label">Descripci√≥n</label>
          <textarea class="form-textarea" rows="4" placeholder="Describe lo que incluye..."></textarea>
        </div>

        <button type="button" class="btn-telegram-cta" onclick="startUploadProcess()">
          Publicar √çtem
        </button>

      </form>

    </div>
  </div>

  <script>
    // 1. L√≥gica para mostrar/ocultar campos de suscripci√≥n
    function toggleSubFields() {
      const category = document.getElementById('categorySelect').value;
      const subFields = document.getElementById('subFields');
      const fileField = document.getElementById('fileField');

      if (category === 'sub') {
        subFields.style.display = 'block';
        fileField.style.display = 'none';
      } else {
        subFields.style.display = 'none';
        fileField.style.display = 'block';
      }
    }

    // 2. L√≥gica visual de moneda
    function selectCurrency(element, type) {
      document.querySelectorAll('.currency-option').forEach(el => el.classList.remove('active'));
      element.classList.add('active');
    }

    // 3. L√ìGICA DE SUBIDA DE ARCHIVOS (NUEVA)
    const dropZone = document.getElementById('dropZone');
    const fileInput = document.getElementById('realFileInput');
    const fileNameDisplay = document.getElementById('fileNameDisplay');

    // Activar input al tocar el √°rea
    dropZone.addEventListener('click', () => fileInput.click());

    // Mostrar nombre del archivo seleccionado
    fileInput.addEventListener('change', () => {
      if (fileInput.files.length > 0) {
        fileNameDisplay.innerText = "üìÑ " + fileInput.files[0].name;
        fileNameDisplay.style.color = "#ccf381";
        dropZone.style.borderColor = "#ccf381";
      }
    });

    // Funci√≥n principal de subida (Simulada para visualizaci√≥n)
    function startUploadProcess() {
      const category = document.getElementById('categorySelect').value;
      
      // Si es una suscripci√≥n, no hay archivo que subir, pasa directo
      if(category === 'sub') {
        alert("Suscripci√≥n creada exitosamente.");
        window.location.href = "marketplace.html";
        return;
      }

      // Validar si hay archivo
      if (fileInput.files.length === 0) {
        alert("Por favor selecciona un archivo para subir.");
        return;
      }

      // Mostrar barra
      const progressBox = document.getElementById('uploadProgressBox');
      const progressBar = document.getElementById('uploadProgressBar');
      const statusText = document.getElementById('uploadStatus');
      
      progressBox.style.display = 'block';
      statusText.style.display = 'block';

      let percent = 0;
      // Intervalo para simular carga (En producci√≥n usar√≠as XMLHttpRequest upload.onprogress)
      const interval = setInterval(() => {
        // Velocidad aleatoria
        percent += Math.floor(Math.random() * 5) + 2; 
        
        if (percent > 100) percent = 100;

        progressBar.style.width = percent + '%';
        statusText.innerText = `Subiendo archivo... ${percent}%`;

        if (percent === 100) {
          clearInterval(interval);
          statusText.innerText = "¬°Procesando datos...";
          statusText.style.color = "#ccf381";
          
          setTimeout(() => {
            alert("√çtem publicado exitosamente en el Marketplace.");
            window.location.href = "marketplace.html";
          }, 800);
        }
      }, 100); // Velocidad del loop
    }
  </script>

</body>
</html>
