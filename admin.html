<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Kisaki Admin Console</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  
  <style>
    /* --- VARIABLES & RESET --- */
    :root {
      --bg-amoled: #000000;
      --bg-card: #09090b;
      --text-main: #ffffff;
      --text-sec: #94a3b8;
      
      /* GRADIENTES SOLICITADOS */
      --grad-navy: #0f172a;
      --grad-blue: #2563eb;
      --grad-cobalt: #e0e7ff;
      
      --accent-glow: rgba(37, 99, 235, 0.5);
    }

    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'SF Pro Display', 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }

    body {
      background-color: var(--bg-amoled);
      color: var(--text-main);
      padding: 20px;
      padding-bottom: 100px;
      min-height: 100vh;
    }

    /* --- HEADER --- */
    .header {
      display: flex; justify-content: space-between; align-items: center;
      margin-bottom: 30px;
    }
    .title h1 { font-size: 1.5em; font-weight: 700; letter-spacing: -0.5px; }
    .title span { color: var(--grad-blue); font-size: 0.9em; }
    
    .btn-add {
      background: linear-gradient(135deg, var(--grad-blue), #1d4ed8);
      width: 40px; height: 40px; border-radius: 12px;
      display: flex; align-items: center; justify-content: center;
      box-shadow: 0 4px 15px var(--accent-glow);
      border: none; color: white; font-size: 1.5em; cursor: pointer;
      transition: transform 0.2s;
    }
    .btn-add:active { transform: scale(0.9); }

    /* --- LISTA TIPO LEADERBOARD --- */
    .admin-list { display: flex; flex-direction: column; gap: 15px; }

    .admin-card {
      position: relative;
      background: linear-gradient(90deg, #0f172a 0%, #000000 100%);
      padding: 15px;
      border-radius: 18px;
      display: flex; align-items: center; justify-content: space-between;
      border: 1px solid rgba(255,255,255,0.08);
      overflow: hidden;
      transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    }

    /* El efecto de borde gradiente sutil */
    .admin-card::before {
      content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 4px;
      background: linear-gradient(to bottom, var(--grad-blue), var(--grad-cobalt));
      border-radius: 4px 0 0 4px;
    }

    .admin-card:active { transform: scale(0.98); border-color: var(--grad-blue); }

    .user-info { display: flex; align-items: center; gap: 12px; }
    
    .avatar {
      width: 45px; height: 45px; border-radius: 50%;
      background: #1e293b; border: 2px solid #000;
      box-shadow: 0 0 0 2px var(--grad-navy);
      display: flex; align-items: center; justify-content: center;
      font-weight: bold; font-size: 1.1em; color: var(--grad-cobalt);
    }

    .details h3 { font-size: 1em; font-weight: 600; }
    .details p { font-size: 0.8em; color: var(--text-sec); display: flex; align-items: center; gap: 5px; }
    
    .status-dot { width: 6px; height: 6px; background: #22c55e; border-radius: 50%; display: inline-block; }

    .btn-edit {
      background: rgba(255,255,255,0.05);
      padding: 8px 14px; border-radius: 20px;
      font-size: 0.8em; color: var(--grad-cobalt);
      border: 1px solid rgba(255,255,255,0.1);
    }

    /* --- MODAL DE PERMISOS (Estilo Tasks Project) --- */
    .modal-overlay {
      position: fixed; inset: 0; background: rgba(0,0,0,0.8);
      backdrop-filter: blur(8px); z-index: 100;
      opacity: 0; pointer-events: none; transition: opacity 0.3s;
      display: flex; align-items: flex-end; /* Sheet style bottom */
    }
    .modal-overlay.open { opacity: 1; pointer-events: auto; }

    .permission-sheet {
      width: 100%;
      background: #121212;
      border-top-left-radius: 30px; border-top-right-radius: 30px;
      padding: 25px;
      border-top: 1px solid rgba(255,255,255,0.15);
      box-shadow: 0 -10px 40px rgba(0,0,0,0.8);
      transform: translateY(100%); transition: transform 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
      padding-bottom: 50px;
    }
    .modal-overlay.open .permission-sheet { transform: translateY(0); }

    .sheet-header {
      display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;
    }
    .sheet-title { font-size: 1.2em; font-weight: 700; color: white; }
    .close-btn { background: none; border: none; color: var(--text-sec); font-size: 1.5em; cursor: pointer; }

    /* --- CHECKBOXES GRANULARES --- */
    .perm-list { display: flex; flex-direction: column; gap: 12px; }

    .perm-item {
      display: flex; align-items: center; gap: 15px;
      padding: 12px; border-radius: 12px;
      transition: background 0.2s;
    }
    .perm-item:active { background: rgba(255,255,255,0.05); }

    /* Custom Checkbox Design (Cuadrado redondeado como la imagen) */
    .custom-check {
      width: 24px; height: 24px;
      border: 2px solid #334155; border-radius: 8px;
      display: flex; align-items: center; justify-content: center;
      transition: all 0.2s; cursor: pointer; flex-shrink: 0;
    }
    
    .custom-check.checked {
      background: var(--grad-blue); border-color: var(--grad-blue);
      box-shadow: 0 0 10px var(--accent-glow);
    }
    .custom-check svg { display: none; width: 14px; height: 14px; stroke: white; stroke-width: 3; }
    .custom-check.checked svg { display: block; }

    .perm-text { display: flex; flex-direction: column; }
    .perm-name { font-size: 0.95em; color: #fff; font-weight: 500; }
    .perm-desc { font-size: 0.75em; color: #64748b; }

    /* Botón Guardar */
    .btn-save {
      width: 100%; margin-top: 25px;
      background: white; color: black;
      padding: 16px; border-radius: 16px;
      font-weight: 700; border: none; font-size: 1em;
      box-shadow: 0 5px 20px rgba(255,255,255,0.1);
      cursor: pointer;
    }
    .btn-save:active { transform: scale(0.98); opacity: 0.9; }

  </style>
</head>
<body>

  <div class="header">
    <div class="title">
      <h1>Admin Squad</h1>
      <span>Kisaki Management</span>
    </div>
    <button class="btn-add" onclick="tg.showAlert('Abre Telegram para añadir admins nuevos.')">+</button>
  </div>

  <div class="admin-list" id="adminList">
    </div>

  <div id="permModal" class="modal-overlay">
    <div class="permission-sheet">
      <div class="sheet-header">
        <div class="sheet-title" id="modalTitle">Permisos</div>
        <button class="close-btn" onclick="toggleModal(false)">✕</button>
      </div>

      <div class="perm-list">
        <div class="perm-item" onclick="toggleCheck(this)">
          <div class="custom-check checked"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><polyline points="20 6 9 17 4 12"></polyline></svg></div>
          <div class="perm-text">
            <span class="perm-name">Cambiar Info del Canal</span>
            <span class="perm-desc">Editar título, foto y descripción</span>
          </div>
        </div>

        <div class="perm-item" onclick="toggleCheck(this)">
          <div class="custom-check checked"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><polyline points="20 6 9 17 4 12"></polyline></svg></div>
          <div class="perm-text">
            <span class="perm-name">Publicar Mensajes</span>
            <span class="perm-desc">Enviar contenido al canal</span>
          </div>
        </div>

        <div class="perm-item" onclick="toggleCheck(this)">
          <div class="custom-check"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><polyline points="20 6 9 17 4 12"></polyline></svg></div>
          <div class="perm-text">
            <span class="perm-name">Editar Mensajes de otros</span>
            <span class="perm-desc">Modificar posts existentes</span>
          </div>
        </div>

        <div class="perm-item" onclick="toggleCheck(this)">
          <div class="custom-check"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><polyline points="20 6 9 17 4 12"></polyline></svg></div>
          <div class="perm-text">
            <span class="perm-name">Eliminar Mensajes</span>
            <span class="perm-desc">Borrar contenido de cualquiera</span>
          </div>
        </div>

        <div class="perm-item" onclick="toggleCheck(this)">
          <div class="custom-check checked"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><polyline points="20 6 9 17 4 12"></polyline></svg></div>
          <div class="perm-text">
            <span class="perm-name">Gestionar Usuarios</span>
            <span class="perm-desc">Añadir suscriptores o banear</span>
          </div>
        </div>
      </div>

      <button class="btn-save" onclick="savePermissions()">Guardar Cambios</button>
    </div>
  </div>

  <script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    // Datos simulados de Admins Reales
    const admins = [
      { id: 1, name: 'Vicente', role: 'Propietario', avatar: 'V' },
      { id: 2, name: 'Kisaki Bot', role: 'Todo acceso', avatar: 'K' },
      { id: 3, name: 'Elena Manager', role: 'Limitado', avatar: 'E' },
      { id: 4, name: 'Support Team', role: 'Limitado', avatar: 'S' }
    ];

    // Renderizar Lista
    const list = document.getElementById('adminList');
    
    admins.forEach(admin => {
      const card = document.createElement('div');
      card.className = 'admin-card';
      card.onclick = () => openPermissions(admin.name); // Microinteracción al tocar
      
      card.innerHTML = `
        <div class="user-info">
          <div class="avatar">${admin.avatar}</div>
          <div class="details">
            <h3>${admin.name}</h3>
            <p><span class="status-dot"></span> ${admin.role}</p>
          </div>
        </div>
        <div class="btn-edit">Ajustar</div>
      `;
      list.appendChild(card);
    });

    // Lógica Modal
    function toggleModal(show) {
      const modal = document.getElementById('permModal');
      if (show) {
        modal.classList.add('open');
        tg.HapticFeedback.impactOccurred('light');
      } else {
        modal.classList.remove('open');
      }
    }

    function openPermissions(name) {
      document.getElementById('modalTitle').innerText = `Permisos de ${name}`;
      toggleModal(true);
    }

    // Lógica Checkbox (Visual)
    function toggleCheck(item) {
      const check = item.querySelector('.custom-check');
      check.classList.toggle('checked');
      tg.HapticFeedback.selectionChanged(); // Vibración sutil
    }

    function savePermissions() {
      tg.HapticFeedback.notificationOccurred('success');
      toggleModal(false);
      // Aquí iría la lógica para enviar a Supabase/Telegram API
      setTimeout(() => {
        tg.showAlert("Permisos actualizados correctamente");
      }, 300);
    }

  </script>
</body>
</html>
