<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Kisaki Manager WebApp</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link rel="stylesheet" href="style.css">
  <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>

  <style>
    /* =========================================
       ESTILOS ESPEC칈FICOS WEB APP
       ========================================= */
    
    /* Centrado del Header */
    .main-header { text-align: center; margin-bottom: 25px; }
    
    /* Resultados B칰squeda */
    .search-results {
      background: #0f172a; border: 1px solid rgba(255,255,255,0.1); border-radius: 12px;
      margin-top: 10px; max-height: 200px; overflow-y: auto; display: none;
      box-shadow: 0 10px 30px rgba(0,0,0,0.5); pointer-events: auto;
    }
    .search-result-item { display: block; padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05); color: white; text-decoration: none; }

    /* Destacados (Banners Grandes) */
    .market-featured-container {
      display: flex; overflow-x: auto; gap: 15px; padding: 10px 0 20px 0;
      scrollbar-width: none; scroll-snap-type: x mandatory;
    }
    .featured-banner {
      min-width: 90%; height: 160px; border-radius: 20px; position: relative;
      overflow: hidden; scroll-snap-align: center; border: 1px solid rgba(255,255,255,0.1);
      background-size: cover; background-position: center;
    }
    .banner-overlay {
      position: absolute; bottom: 0; left: 0; width: 100%;
      background: linear-gradient(to top, rgba(0,0,0,0.9), transparent); padding: 15px; box-sizing: border-box;
    }
    .banner-badge {
      position: absolute; top: 10px; right: 10px; background: #ef4444; color: white;
      font-size: 0.75em; font-weight: 800; padding: 4px 8px; border-radius: 6px;
    }

    /* Bot칩n Flotante Subir (Visible) */
    .btn-upload-fixed {
      position: fixed; bottom: 90px; right: 20px;
      width: 56px; height: 56px; background-color: #ccf381; color: #000;
      border-radius: 50%; display: flex; align-items: center; justify-content: center;
      box-shadow: 0 5px 20px rgba(0,0,0,0.5); z-index: 999;
      transition: transform 0.2s;
    }
    .btn-upload-fixed:active { transform: scale(0.9); }

    /* Paginaci칩n */
    .pagination-container { display: flex; justify-content: center; gap: 8px; margin-top: 20px; padding-bottom: 80px; }
    .page-dot { width: 32px; height: 32px; border-radius: 50%; background: rgba(255,255,255,0.1); color: white; border: none; font-size: 0.9em; cursor: pointer; }
    .page-dot.active { background: #ccf381; color: black; font-weight: bold; }

    /* Acorde칩n Planes (Estilo embebido para asegurar funcionamiento) */
    .pricing-content { max-height: 0; opacity: 0; overflow: hidden; transition: all 0.3s ease; }
    .pricing-card.active .pricing-content { max-height: 300px; opacity: 1; margin-top: 15px; padding-top: 10px; border-top: 1px solid rgba(255,255,255,0.1); }
  </style>
</head>

<body>
  
  <div class="container" style="padding-top: 20px;">

    <header class="main-header">
      <h1>Kisaki Manager</h1>
      <p class="subtitle">WebApp Oficial v2.0</p>
    </header>

    <section id="section-home" class="app-section active">
      
      <div class="news-card">
        <div class="news-content">
          <span class="news-badge">游댒 Novedades v1.4.0</span>
          <h3>Lanzamiento WebApp Oficial</h3>
          <p>Kisaki Manager ahora funciona como una aplicaci칩n nativa. Navega sin recargas.</p>
          <div class="blog-reactions">
            <button class="reaction-btn" onclick="react(this)">游녨 <span class="count">124</span></button>
            <button class="reaction-btn" onclick="react(this)">仇벒잺 <span class="count">45</span></button>
          </div>
        </div>
      </div>

      <a href="#" onclick="switchSection('plans')" class="btn-card" style="background: linear-gradient(135deg, #3b82f6, #2563eb); justify-content: space-between; margin-top: 20px;">
        <div style="display:flex; flex-direction:column; align-items:flex-start;">
          <span style="font-size:1.1em; font-weight:700;">Funciones Premium</span>
          <span style="font-size:0.85em; opacity:0.9;">Ver planes y beneficios</span>
        </div>
        <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18l6-6-6-6"/></svg>
      </a>

      <div style="margin-top: 25px;">
        <h3 style="text-align: left; color: #fff; margin-bottom:10px;">Acceso R치pido</h3>
        <a href="https://t.me/KisakiManagerBot" class="btn-telegram-cta" style="background: linear-gradient(135deg, #f59e0b, #d97706); box-shadow: 0 10px 25px rgba(245, 158, 11, 0.3);" target="_blank">
          <span>Abrir Bot Oficial</span>
          <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M20.665 3.717l-17.73 6.837c-1.21.486-1.203 1.161-.222 1.462l4.552 1.42 10.532-6.645c.498-.303.953-.14.579.192l-8.533 7.701h-.002l.002.001-.314 4.692c.46 0 .663-.211.921-.46l2.211-2.15 4.599 3.397c.848.467 1.457.227 1.668-.793l3.016-14.208c.309-1.239-.473-1.8-1.282-1.444z"/></svg>
        </a>
      </div>
    </section>

    <section id="section-plans" class="app-section">
      <h2 style="color: white; margin-bottom: 20px;">Planes Disponibles</h2>
      
      <div class="pricing-container">
        <div class="pricing-card" onclick="toggleCard(this)">
          <div class="pricing-header">
            <div><span class="pricing-title">Telegram Business</span><div class="pricing-price">$4.99 <span class="pricing-sub">/ mes</span></div></div>
            <span class="pricing-badge">Mensual</span>
          </div>
          <div class="pricing-content">
            <ul>
              <li><svg class="check-icon" viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg> Automatizaci칩n</li>
              <li><svg class="check-icon" viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg> Horarios</li>
            </ul>
            <a href="#" class="btn-buy">Adquirir</a>
          </div>
        </div>
        <div class="pricing-card" onclick="toggleCard(this)">
          <div class="pricing-header">
            <div><span class="pricing-title">Clonar Bot</span><div class="pricing-price">$29.99 <span class="pricing-sub">/ 칰nico</span></div></div>
            <span class="pricing-badge" style="background:rgba(37,99,235,0.2); color:#60a5fa;">Lifetime</span>
          </div>
          <div class="pricing-content">
            <ul>
              <li><svg class="check-icon" viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg> Tu propia marca</li>
              <li><svg class="check-icon" viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg> C칩digo fuente</li>
            </ul>
            <a href="#" class="btn-buy">Clonar</a>
          </div>
        </div>
      </div>
    </section>

    <section id="section-market" class="app-section">
      
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h2 style="margin: 0; color: white;">Marketplace</h2>
        <span style="font-size: 0.8em; color: #fbbf24; background: rgba(251, 191, 36, 0.1); padding: 4px 8px; border-radius: 8px;">7% fee</span>
      </div>

      <div class="market-featured-container">
        <div class="featured-banner" style="background-image: linear-gradient(135deg, #ec4899, #be185d);">
          <span class="banner-badge">-20%</span>
          <div class="banner-overlay"><h3 style="margin:0; color:white;">Pack Anime Premium</h3><span style="color:#ccf381;">2.0 TON</span></div>
        </div>
        <div class="featured-banner" style="background-image: linear-gradient(135deg, #3b82f6, #1e40af);">
          <div class="banner-overlay"><h3 style="margin:0; color:white;">Se침ales VIP</h3><span style="color:#fbbf24;">500 Stars</span></div>
        </div>
      </div>

      <div class="market-nav">
        <div class="market-tab active" onclick="renderMarket('all', 1, this)">Todo</div>
        <div class="market-tab" onclick="renderMarket('art', 1, this)">Ilustraciones</div>
        <div class="market-tab" onclick="renderMarket('vip', 1, this)">Suscripciones</div>
        <div class="market-tab" onclick="renderMarket('sticker', 1, this)">Stickers</div>
        <div class="market-tab" onclick="renderMarket('other', 1, this)">Otros</div>
      </div>

      <div id="products-container" class="products-grid"></div>

      <div id="pagination-container" class="pagination-container"></div>

      <a href="upload.html" class="btn-upload-fixed">
        <svg width="28" height="28" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
      </a>

    </section>

    <section id="section-legal" class="app-section">
      <h2 style="color: white; margin-bottom: 20px;">Centro Legal</h2>
      
      <div class="buttons-list">
        <a class="btn-card" href="about.html">
          <div class="icon-wrapper"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg></div>
          <div class="card-text"><span class="card-title">Sobre Kisaki</span><span class="card-desc">Misi칩n y Creador</span></div>
        </a>

        <a class="btn-card" href="payment-policies.html">
          <div class="icon-wrapper"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="5" width="20" height="14" rx="2"/><line x1="2" y1="10" x2="22" y2="10"/></svg></div>
          <div class="card-text"><span class="card-title">Pol칤ticas de Pago</span><span class="card-desc">Reembolsos y Seguridad</span></div>
        </a>
        <a class="btn-card" href="privacy.html">
          <div class="icon-wrapper"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg></div>
          <div class="card-text"><span class="card-title">Privacidad</span><span class="card-desc">Protecci칩n de datos</span></div>
        </a>
        <a class="btn-card" href="terms.html">
          <div class="icon-wrapper"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg></div>
          <div class="card-text"><span class="card-title">T칠rminos</span><span class="card-desc">Reglas del servicio</span></div>
        </a>
        <a class="btn-card" href="minors.html">
          <div class="icon-wrapper"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v2"/></svg></div>
          <div class="card-text"><span class="card-title">Menores</span><span class="card-desc">Restricciones de edad</span></div>
        </a>
      </div>
    </section>

    <section id="section-profile" class="app-section">
      <div class="profile-card-inner">
        <img src="https://cdn-icons-png.flaticon.com/512/147/147144.png" class="profile-avatar" style="border: 3px solid #ccf381;">
        <h2 class="profile-name">Vicente</h2>
        <span class="profile-role">Admin / Vendedor</span>
        <div class="profile-stats">
          <div class="stat-box"><span class="stat-num">0</span><span class="stat-label">Ventas</span></div>
          <div class="stat-box"><span class="stat-num">5</span><span class="stat-label">칈tems</span></div>
        </div>
        <button class="btn-ton-connect"><svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M21 18v1c0 1.1-.9 2-2 2H5c-1.11 0-2-.9-2-2V5c0-1.1.89-2 2-2h14c1.1 0 2 .9 2 2v1h-9c-1.11 0-2 .9-2 2v8c0 1.1.89 2 2 2h9zm-9-2h10V8H12v8zm4-2.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/></svg> Conectar Wallet</button>
      </div>
      <div class="content-bubble">
        <h2>游닍 Mis Publicaciones</h2>
        <p style="text-align:center; color:#64748b; margin-top:15px;">Gestiona tus ventas aqu칤.</p>
      </div>
    </section>

  </div> <div class="search-overlay" id="searchOverlay">
    <input type="text" class="search-input" id="globalSearchInput" placeholder="Buscar 칤tems, pol칤ticas..." onkeyup="globalSearch()">
    <div class="search-results" id="searchResults"></div>
  </div>

  <nav class="bottom-nav">
    <div class="nav-item active" onclick="switchSection('home', this)">
      <svg fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
      Inicio
    </div>
    <div class="nav-item" onclick="switchSection('market', this)">
      <svg fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path d="M20.38 3.4a2 2 0 0 0-1.79-1.11H5.41a2 2 0 0 0-1.79 1.11L1 9h22l-2.62-5.6z"/><path d="M1 9h22v10a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V9z"/></svg>
      Market
    </div>
    <div class="nav-item" onclick="toggleSearch()">
      <div class="nav-search-btn">
        <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
      </div>
    </div>
    <div class="nav-item" onclick="switchSection('legal', this)">
      <svg fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
      Legal
    </div>
    <div class="nav-item" onclick="switchSection('profile', this)">
      <svg fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
      Perfil
    </div>
  </nav>

  <script>
    // --- 1. MEMORIA Y NAVEGACI칍N ---
    document.addEventListener("DOMContentLoaded", () => {
      generateDummyItems(); // Generar 칤tems falsos para probar
      const lastSection = localStorage.getItem('kisaki_last_section') || 'home';
      switchSection(lastSection);
    });

    function switchSection(sectionId, element) {
      // Diferenciar 'Legal' (Navbar) de 'Plans' (Home)
      let targetId = sectionId === 'legal' ? 'legal' : sectionId;
      
      // Ocultar todo
      document.querySelectorAll('.app-section').forEach(sec => sec.classList.remove('active'));
      
      // Mostrar destino
      const target = document.getElementById('section-' + targetId);
      if(target) target.classList.add('active');

      // Guardar en memoria
      localStorage.setItem('kisaki_last_section', sectionId);

      // Actualizar Navbar (Visual)
      const navItems = document.querySelectorAll('.nav-item');
      navItems.forEach(n => n.classList.remove('active'));
      
      // Mapeo manual de iconos
      if(sectionId === 'home') navItems[0].classList.add('active');
      else if(sectionId === 'market') navItems[1].classList.add('active');
      else if(sectionId === 'legal') navItems[3].classList.add('active');
      else if(sectionId === 'profile') navItems[4].classList.add('active');
      // Si es 'plans', no activamos ning칰n icono de navbar espec칤fico (se queda en el 칰ltimo o ninguno)

      document.getElementById('searchOverlay').classList.remove('show');
      window.scrollTo(0,0);
    }

    // --- 2. MARKETPLACE L칍GICA (Paginaci칩n + Filtros) ---
    const allItems = []; 
    let currentCategory = 'all';
    let currentPage = 1;
    const itemsPerPage = 15;

    // Generar 45 items falsos para probar las 3 p치ginas
    function generateDummyItems() {
      const types = ['art', 'sticker', 'vip', 'other'];
      for(let i=1; i<=45; i++) {
        const type = types[Math.floor(Math.random() * types.length)];
        allItems.push({
          id: i, type: type,
          title: `Demo Item ${i}`,
          price: (Math.random() * 5).toFixed(1) + ' TON',
          seller: '@Vendedor' + i,
          color: type === 'vip' ? '#3b82f6' : (type==='art' ? '#ec4899' : '#f59e0b')
        });
      }
      renderMarket('all', 1);
    }

    function renderMarket(category, page, tabElement) {
      currentCategory = category;
      currentPage = page;

      // Actualizar Tabs
      if(tabElement) {
        document.querySelectorAll('.market-tab').forEach(t => t.classList.remove('active'));
        tabElement.classList.add('active');
      }

      // Filtrar
      const filtered = allItems.filter(item => category === 'all' || item.type === category);

      // Paginar
      const start = (page - 1) * itemsPerPage;
      const end = start + itemsPerPage;
      const itemsToShow = filtered.slice(start, end);

      // Renderizar
      const container = document.getElementById('products-container');
      container.innerHTML = '';
      
      itemsToShow.forEach(item => {
        const div = document.createElement('div');
        div.className = `product-card filter-item ${item.type}`;
        div.innerHTML = `
          <div class="product-image" style="background-color: ${item.color};"></div>
          <div class="product-info">
            <h3 class="product-title">${item.title}</h3>
            <div class="product-seller">${item.seller}</div>
            <div class="product-price-row"><span class="price-tag-ton">游눑 ${item.price}</span></div>
          </div>
        `;
        container.appendChild(div);
      });

      // Renderizar Botones Paginaci칩n
      const totalPages = Math.ceil(filtered.length / itemsPerPage);
      const pagContainer = document.getElementById('pagination-container');
      pagContainer.innerHTML = '';

      if(totalPages > 1) {
        for(let i=1; i<=totalPages; i++) {
          const btn = document.createElement('button');
          btn.className = `page-dot ${i === page ? 'active' : ''}`;
          btn.innerText = i;
          btn.onclick = () => renderMarket(currentCategory, i);
          pagContainer.appendChild(btn);
        }
      }
    }

    // --- 3. ACORDE칍N PLANES ---
    function toggleCard(card) {
      if (card.classList.contains('active')) {
        card.classList.remove('active');
      } else {
        document.querySelectorAll('.pricing-card').forEach(c => c.classList.remove('active'));
        card.classList.add('active');
      }
    }

    // --- 4. B칔SQUEDA ---
    function toggleSearch() {
      const overlay = document.getElementById('searchOverlay');
      overlay.classList.toggle('show');
      if(overlay.classList.contains('show')) document.getElementById('globalSearchInput').focus();
    }

    function globalSearch() {
      const input = document.getElementById('globalSearchInput').value.toLowerCase();
      const resultsDiv = document.getElementById('searchResults');
      resultsDiv.innerHTML = '';

      const data = [
        {t: 'Planes Premium', a: "javascript:switchSection('plans')"},
        {t: 'T칠rminos de Uso', a: "terms.html"},
        {t: 'Marketplace', a: "javascript:switchSection('market')"},
        {t: 'Reembolsos', a: "payment-policies.html"}
      ];

      if(input.length > 1) {
        const matches = data.filter(d => d.t.toLowerCase().includes(input));
        if(matches.length > 0) {
          resultsDiv.style.display = 'block';
          matches.forEach(m => {
             resultsDiv.innerHTML += `<a href="${m.a}" class="search-result-item" onclick="toggleSearch()">${m.t}</a>`;
          });
        } else { resultsDiv.style.display = 'none'; }
      } else { resultsDiv.style.display = 'none'; }
    }

    function react(btn) {
      btn.classList.toggle('active');
      let count = parseInt(btn.querySelector('.count').innerText);
      btn.querySelector('.count').innerText = btn.classList.contains('active') ? count + 1 : count - 1;
    }
  </script>

</body>
</html>
