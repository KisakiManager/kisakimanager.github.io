<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Kisaki Manager</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link rel="stylesheet" href="style.css">

  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <script type="module">
    import { db } from './firebase_config.js';
    console.log("üî• Kisaki Manager: Conexi√≥n a Firebase establecida", db ? "OK" : "Error");

    const tg = window.Telegram.WebApp;
    tg.expand(); 
  </script>
</head>

<body>

  <div class="container" style="padding-top: 20px; padding-bottom: 80px;">

    <header class="main-header" style="text-align:center; margin-bottom:25px;">
      <h1>Kisaki Manager</h1>
      <p class="subtitle">WebApp Oficial v2.0</p>
    </header>

    <div class="news-card">
      <div class="news-content">
        <span class="news-badge">üîî Novedades v1.4.0</span>
        <h3>Lanzamiento WebApp Oficial</h3>
        <p>Kisaki Manager ahora funciona como una aplicaci√≥n nativa. Navega por las secciones usando la barra inferior.</p>
        <div class="blog-reactions" style="display:flex; gap:10px; margin-top:15px; border-top:1px solid rgba(255,255,255,0.1); padding-top:10px;">
          <button class="reaction-btn" style="background:rgba(255,255,255,0.1); border:none; border-radius:20px; padding:5px 10px; color:#fff;" onclick="this.style.color='#ccf381'">üëç 124</button>
          <button class="reaction-btn" style="background:rgba(255,255,255,0.1); border:none; border-radius:20px; padding:5px 10px; color:#fff;" onclick="this.style.color='#f87171'">‚ù§Ô∏è 45</button>
        </div>
      </div>
    </div>

    <a href="analytics.html" class="menu-card analytics-card" style="margin-top: 20px; text-decoration: none; display: flex; flex-direction: column; background: linear-gradient(145deg, #1e293b, #0f172a); border: 1px solid rgba(204, 243, 129, 0.2); border-radius: 16px; padding: 20px; position: relative; overflow: hidden;">
      <div class="card-bg-icon" style="position: absolute; right: -10px; bottom: -10px; opacity: 0.05; transform: rotate(-15deg) scale(2.5); color: #ccf381;">
        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 3v18h18"/><path d="M18 9l-5 5-4-4-6 6"/></svg>
      </div>
      <div class="card-content" style="z-index: 2;">
        <div class="icon-box" style="margin-bottom: 10px;">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#ccf381" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="18" y1="20" x2="18" y2="10"></line>
            <line x1="12" y1="20" x2="12" y2="4"></line>
            <line x1="6" y1="20" x2="6" y2="14"></line>
          </svg>
        </div>
        <h3 style="margin: 0; color: white; font-size: 1.1em;">Analytics</h3>
        <span style="font-size: 0.7em; background: #ccf381; color: #000; padding: 2px 6px; border-radius: 4px; font-weight: 800; display: inline-block; margin-top: 5px;">PRO</span>
      </div>
    </a>

    <a href="clones.html" class="menu-card" style="background: linear-gradient(145deg, #312e81, #1e1b4b); border: 1px solid rgba(99, 102, 241, 0.3); text-decoration: none; border-radius: 16px; padding: 15px; display: flex; align-items: center; gap: 15px; margin-top: 15px;">
      <div style="background: rgba(255,255,255,0.1); padding: 10px; border-radius: 12px; color: #818cf8;">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="2" width="20" height="8" rx="2" ry="2"></rect><rect x="2" y="14" width="20" height="8" rx="2" ry="2"></rect><line x1="6" y1="6" x2="6.01" y2="6"></line><line x1="6" y1="18" x2="6.01" y2="18"></line></svg>
      </div>
      <div>
        <h3 style="margin: 0; color: white; font-size: 1em;">Mis Bots</h3>
        <span style="font-size: 0.8em; color: #a5b4fc;">Gestionar Clones</span>
      </div>
    </a>

    <a href="publisher.html" class="menu-card" style="background: linear-gradient(145deg, #be185d, #831843); border: 1px solid rgba(244, 114, 182, 0.3); text-decoration: none; border-radius: 16px; padding: 15px; display: flex; align-items: center; gap: 15px; margin-top: 15px;">
      <div style="background: rgba(255,255,255,0.1); padding: 10px; border-radius: 12px; color: #f472b6;">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"></path></svg>
      </div>
      <div>
        <h3 style="margin: 0; color: white; font-size: 1em;">Studio</h3>
        <span style="font-size: 0.8em; color: #fbcfe8;">Crear y Publicar</span>
      </div>
    </a>

    <a href="upgrade.html" class="btn-card" style="background: linear-gradient(135deg, #3b82f6, #2563eb); justify-content: space-between; margin-top: 20px;">
      <div style="display:flex; flex-direction:column; align-items:flex-start;">
        <span style="font-size:1.1em; font-weight:700;">Funciones Premium</span>
        <span style="font-size:0.85em; opacity:0.9;">Ver planes y beneficios</span>
      </div>
      <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18l6-6-6-6"/></svg>
    </a>

    <div style="margin-top: 25px;">
      <h3 style="text-align: left; color: #fff; margin-bottom:10px;">Acceso R√°pido</h3>
      <a href="https://t.me/KisakiManagerBot" class="btn-telegram-cta" style="background: linear-gradient(135deg, #f59e0b, #d97706); box-shadow: 0 10px 25px rgba(245, 158, 11, 0.3);" target="_blank">
        <span>Abrir Bot Oficial</span>
        <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M20.665 3.717l-17.73 6.837c-1.21.486-1.203 1.161-.222 1.462l4.552 1.42 10.532-6.645c.498-.303.953-.14.579.192l-8.533 7.701h-.002l.002.001-.314 4.692c.46 0 .663-.211.921-.46l2.211-2.15 4.599 3.397c.848.467 1.457.227 1.668-.793l3.016-14.208c.309-1.239-.473-1.8-1.282-1.444z"/></svg>
      </a>
    </div>

  </div>

  <div class="search-overlay" id="searchOverlay">
    <input type="text" class="search-input" id="globalSearchInput" placeholder="Buscar..." onkeyup="handleSearch(event)">
    <div class="search-results" id="searchResults"></div>
  </div>

  <nav class="bottom-nav" style="padding: 10px 5px; gap: 2px;">

    <a href="index.html" class="nav-item active" style="font-size: 0.65em;">
        <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
        Inicio
    </a>

    <a href="marketplace.html" class="nav-item" style="font-size: 0.65em;">
        <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M20.38 3.4a2 2 0 0 0-1.79-1.11H5.41a2 2 0 0 0-1.79 1.11L1 9h22l-2.62-5.6z"/><path d="M1 9h22v10a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V9z"/></svg>
        Market
    </a>

    <a href="analytics.html" class="nav-item" style="font-size: 0.65em;">
        <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><line x1="18" y1="20" x2="18" y2="10"></line><line x1="12" y1="20" x2="12" y2="4"></line><line x1="6" y1="20" x2="6" y2="14"></line></svg>
        Stats
    </a>

    <div class="nav-item" onclick="toggleSearch()" style="min-width: 50px;">
        <div class="nav-search-btn" style="width: 42px; height: 42px;">
            <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
        </div>
    </div>

    <a href="legal.html" class="nav-item" style="font-size: 0.65em;">
        <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
        Legal
    </a>

    <a href="profile.html" class="nav-item" style="font-size: 0.65em;">
        <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
        Perfil
    </a>

  </nav>

  <script>
    function toggleSearch() {
      document.getElementById('searchOverlay').classList.toggle('show');
      if(document.getElementById('searchOverlay').classList.contains('show')) document.getElementById('globalSearchInput').focus();
    }

    function handleSearch(e) {
      const input = e.target.value.toLowerCase();
      const resultsDiv = document.getElementById('searchResults');

      if (e.key === 'Enter') {
        window.location.href = `search-results.html?q=${encodeURIComponent(input)}`;
        return;
      }

      resultsDiv.innerHTML = '';
      const data = [
        {t: 'Planes Premium', a: 'upgrade.html'}, // ACTUALIZADO A UPGRADE.HTML
        {t: 'Marketplace', a: 'marketplace.html'},
        {t: 'Anal√≠ticas', a: 'analytics.html'},
        {t: 'Mis Bots', a: 'clones.html'},
        {t: 'Studio Creativo', a: 'publisher.html'},
        {t: 'Legal', a: 'legal.html'},
        {t: 'Perfil', a: 'profile.html'}
      ];

      if(input.length > 1) {
        resultsDiv.style.display = 'block';
        const matches = data.filter(d => d.t.toLowerCase().includes(input));
        if(matches.length > 0) {
          matches.forEach(m => {
             resultsDiv.innerHTML += `<a href="${m.a}" class="search-result-item">${m.t}</a>`;
          });
        } else { resultsDiv.style.display = 'none'; }
      } else { resultsDiv.style.display = 'none'; }
    }
  </script>

</body>
</html>
